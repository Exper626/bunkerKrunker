from ultralytics import YOLO
import os

# Paths
DATA_YAML = r"E:\bunkerKrunker\teaPick_data1\data.yaml"
SAVE_DIR = r"E:\bunkerKrunker\results_epoch_train1"

def run():
    # Models and epochs to test
    models = ["yolov8s.pt"]
    epochs_list = [25]

    # Run experiments
    for model_name in models:
        for epochs in epochs_list:
            print(f"\n Training {model_name} for {epochs} epochs...")
            model = YOLO(model_name)
            model.train(
                data=DATA_YAML,
                epochs=epochs,
                batch=16,
                imgsz=640,
                project=SAVE_DIR,
                name=f"{model_name.split('.')[0]}_{epochs}ep",
                device=0  # force GPU
            )

if __name__ == "__main__":   # VERY IMPORTANT on Windows
    run()
